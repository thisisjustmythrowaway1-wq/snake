<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            text-align: center;
            color: #333;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        canvas {
            border: 3px solid #667eea;
            background: #000;
            border-radius: 10px;
            display: block;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 10px;
            font-weight: bold;
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
        }

        .stat-value {
            font-size: 1.5em;
            color: #667eea;
        }

        .controls {
            color: #666;
            font-size: 0.95em;
        }

        .controls p {
            margin: 5px 0;
        }

        button {
            padding: 12px 30px;
            font-size: 1em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .skip-btn {
            padding: 10px 20px;
            font-size: 0.9em;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .skip-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .game-over {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f8d7da;
            color: #721c24;
            border-radius: 10px;
            border: 1px solid #f5c6cb;
        }

        .game-over h2 {
            margin-bottom: 10px;
        }

        /* Unscramble Section */
        .unscramble-area {
            text-align: center;
        }

        .collected-letters {
            background: #f0f0f0;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            letter-spacing: 3px;
            color: #667eea;
            word-break: break-all;
        }

        .answer-display {
            background: #fff9e6;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            min-height: 60px;
            font-size: 1.5em;
            letter-spacing: 4px;
            color: #333;
            border: 2px dashed #ffc107;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .word-blank {
            margin: 0 5px;
        }

        .letter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .letter-btn {
            padding: 10px 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .letter-btn:hover {
            background: #5568d3;
            transform: scale(1.1);
        }

        .letter-btn.used {
            opacity: 0.3;
            cursor: default;
        }

        .letter-btn.used:hover {
            transform: scale(1);
            background: #667eea;
        }

        .unscramble-button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .undo-btn {
            padding: 8px 15px;
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .undo-btn:hover {
            background: #f57c00;
        }

        .clear-btn {
            padding: 8px 15px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .clear-btn:hover {
            background: #5a6268;
        }

        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            display: none;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        .victory {
            text-align: center;
        }

        .victory h2 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 20px;
        }

        .victory p {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 15px;
        }

        .button-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            position: relative;
        }

        .yes-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .yes-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.6);
        }

        .no-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: absolute;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #667eea;
            animation: confettiFall 3s ease-out forwards;
            pointer-events: none;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üêç Snake Game</h1>
        
        <!-- Snake Game Section -->
        <div class="section active" id="snakeSection">
            <div class="game-area">
                <canvas id="gameCanvas" width="600" height="400"></canvas>
                
                <div class="stats">
                    <div class="stat">
                        <div class="stat-label">Letters Collected</div>
                        <div class="stat-value"><span id="score">0</span>/25</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Snake Length</div>
                        <div class="stat-value" id="length">1</div>
                    </div>
                </div>

                <div class="controls">
                    <p><strong>Arrow Keys or WASD to move</strong></p>
                    <p id="gameStatus">Ready to start! Click the button below.</p>
                </div>

                <div class="button-group">
                    <button onclick="startGame()">Start Game</button>
                    <button class="skip-btn" onclick="skipToUnscramble()">Skip Game</button>
                </div>

                <div class="game-over" id="gameOver">
                    <h2 id="gameOverTitle">Game Over!</h2>
                    <p id="gameOverScore"></p>
                    <button onclick="startGame()" style="margin-top: 10px;">Play Again</button>
                </div>
            </div>
        </div>

        <!-- Unscramble Section -->
        <div class="section" id="unscrambleSection">
            <h2 style="margin-bottom: 20px;">üîë Unscramble the Message!</h2>
            <div class="unscramble-area">
                <div class="collected-letters" id="collectedLetters"></div>
                
                <p style="color: #666; margin-bottom: 15px;">Spell out the secret message:</p>
                
                <div class="answer-display" id="answerDisplay"></div>

                <div class="letter-buttons" id="letterButtons"></div>

                <div class="unscramble-button-group">
                    <button class="undo-btn" onclick="undoLetter()">‚Ü∂ Undo</button>
                    <button class="clear-btn" onclick="clearAnswer()">Clear</button>
                    <button onclick="submitAnswer()">Submit Answer</button>
                </div>

                <div class="status" id="status"></div>
            </div>
        </div>

        <!-- Victory Section -->
        <div class="section" id="victorySection">
            <div class="victory">
                <h2>‚ú® Will You Be My Valentine? ‚ú®</h2>
                <p>You solved the puzzle! üéâ</p>
                <p>I love you and I want to make this Valentine's Day special with you.</p>
                <p style="font-size: 1.2em; margin-top: 20px;">So what do you say? üíï</p>
                <div class="button-container">
                    <button class="yes-btn" id="yesBtn" onclick="answerYes()">YES! üéâ</button>
                    <button class="no-btn" id="noBtn" onclick="dodgeNo()">Maybe Later üòä</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const GRID_SIZE = 20;
        const TILE_COUNT_X = canvas.width / GRID_SIZE;
        const TILE_COUNT_Y = canvas.height / GRID_SIZE;
        const SECRET_MESSAGE = "WILLYOUBEMYVALENTINE";
        const MESSAGE_WORDS = ["WILL", "YOU", "BE", "MY", "VALENTINE"];

        let snake = [{ x: 10, y: 10 }];
        let direction = { x: 1, y: 0 };
        let nextDirection = { x: 1, y: 0 };
        let foodItems = [];
        let collectedLetters = [];
        let score = 0;
        let gameRunning = false;
        let gameLoopInterval = null;

        let unscrambleState = {
            available: [],
            answer: []
        };

        function startGame() {
            snake = [{ x: 10, y: 10 }];
            direction = { x: 1, y: 0 };
            nextDirection = { x: 1, y: 0 };
            collectedLetters = [];
            score = 0;
            gameRunning = true;

            generateFoodItems();

            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('gameStatus').textContent = 'Game in progress...';
            document.getElementById('score').textContent = '0';
            document.getElementById('length').textContent = '1';

            clearInterval(gameLoopInterval);
            gameLoopInterval = setInterval(update, 100);
        }

        function skipToUnscramble() {
            gameRunning = false;
            clearInterval(gameLoopInterval);
            collectedLetters = SECRET_MESSAGE.split('');
            createConfetti();
            
            setTimeout(() => {
                showSection('unscrambleSection');
                initializeUnscramble();
            }, 500);
        }

        function generateFoodItems() {
            foodItems = [];
            const letters = SECRET_MESSAGE.split('');

            letters.forEach(letter => {
                let newFood;
                let valid = false;

                while (!valid) {
                    newFood = {
                        x: Math.floor(Math.random() * TILE_COUNT_X),
                        y: Math.floor(Math.random() * TILE_COUNT_Y),
                        letter: letter
                    };

                    valid = !snake.some(seg => seg.x === newFood.x && seg.y === newFood.y) &&
                            !foodItems.some(f => f.x === newFood.x && f.y === newFood.y);
                }

                foodItems.push(newFood);
            });
        }

        function update() {
            if (!gameRunning) return;

            direction = nextDirection;

            const head = snake[0];
            const newHead = {
                x: (head.x + direction.x + TILE_COUNT_X) % TILE_COUNT_X,
                y: (head.y + direction.y + TILE_COUNT_Y) % TILE_COUNT_Y
            };

            // Check collision with self
            if (snake.some(seg => seg.x === newHead.x && seg.y === newHead.y)) {
                endGame();
                return;
            }

            snake.unshift(newHead);

            // Check if food eaten
            const foodIndex = foodItems.findIndex(f => f.x === newHead.x && f.y === newHead.y);
            if (foodIndex !== -1) {
                const letter = foodItems[foodIndex].letter;
                collectedLetters.push(letter);
                foodItems.splice(foodIndex, 1);
                score++;
                document.getElementById('score').textContent = score;

                if (score === SECRET_MESSAGE.length) {
                    completeGame();
                    return;
                }
            } else {
                snake.pop();
            }

            document.getElementById('length').textContent = snake.length;
            draw();
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw grid
            ctx.strokeStyle = '#111';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= canvas.width; i += GRID_SIZE) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i <= canvas.height; i += GRID_SIZE) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }

            // Draw snake
            snake.forEach((segment, index) => {
                ctx.fillStyle = index === 0 ? '#00ff00' : '#00cc00';
                ctx.fillRect(
                    segment.x * GRID_SIZE + 1,
                    segment.y * GRID_SIZE + 1,
                    GRID_SIZE - 2,
                    GRID_SIZE - 2
                );
            });

            // Draw food with letters
            foodItems.forEach(food => {
                ctx.fillStyle = '#ff6b6b';
                ctx.fillRect(
                    food.x * GRID_SIZE + 1,
                    food.y * GRID_SIZE + 1,
                    GRID_SIZE - 2,
                    GRID_SIZE - 2
                );

                ctx.fillStyle = '#fff';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(
                    food.letter,
                    food.x * GRID_SIZE + GRID_SIZE / 2,
                    food.y * GRID_SIZE + GRID_SIZE / 2
                );
            });
        }

        function endGame() {
            gameRunning = false;
            clearInterval(gameLoopInterval);
            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('gameOverScore').textContent = `You collected ${score}/${SECRET_MESSAGE.length} letters. Try again!`;
        }

        function completeGame() {
            gameRunning = false;
            clearInterval(gameLoopInterval);
            createConfetti();
            
            setTimeout(() => {
                showSection('unscrambleSection');
                initializeUnscramble();
            }, 1000);
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(sec => {
                sec.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function initializeUnscramble() {
            unscrambleState.available = [...collectedLetters].sort(() => Math.random() - 0.5);
            unscrambleState.answer = [];

            document.getElementById('collectedLetters').textContent = unscrambleState.available.join(' ');

            const buttonContainer = document.getElementById('letterButtons');
            buttonContainer.innerHTML = '';

            unscrambleState.available.forEach((letter, index) => {
                const btn = document.createElement('button');
                btn.className = 'letter-btn';
                btn.textContent = letter;
                btn.onclick = () => selectLetter(index, letter, btn);
                btn.dataset.index = index;
                buttonContainer.appendChild(btn);
            });

            displayAnswerBlanks();
            document.getElementById('status').style.display = 'none';
        }

        function displayAnswerBlanks() {
            const answerDisplay = document.getElementById('answerDisplay');
            answerDisplay.innerHTML = '';

            MESSAGE_WORDS.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-blank';
                wordDiv.textContent = '_ '.repeat(word.length).trim();
                answerDisplay.appendChild(wordDiv);
            });
        }

        function selectLetter(index, letter, btn) {
            if (!btn.classList.contains('used')) {
                btn.classList.add('used');
                unscrambleState.answer.push({ letter, originalIndex: index });
                updateAnswerDisplay();
            }
        }

        function updateAnswerDisplay() {
            const answer = unscrambleState.answer.map(item => item.letter).join('');
            const answerDisplay = document.getElementById('answerDisplay');
            answerDisplay.innerHTML = '';

            let answerIndex = 0;
            MESSAGE_WORDS.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-blank';
                let wordDisplay = '';

                for (let i = 0; i < word.length; i++) {
                    if (answerIndex < answer.length) {
                        wordDisplay += answer[answerIndex];
                        answerIndex++;
                    } else {
                        wordDisplay += '_ ';
                    }
                    if (i < word.length - 1) wordDisplay += ' ';
                }

                wordDiv.textContent = wordDisplay;
                answerDisplay.appendChild(wordDiv);
            });
        }

        function undoLetter() {
            if (unscrambleState.answer.length > 0) {
                const lastItem = unscrambleState.answer.pop();
                const btn = document.querySelector(`button[data-index="${lastItem.originalIndex}"]`);
                btn.classList.remove('used');
                updateAnswerDisplay();
            }
        }

        function clearAnswer() {
            unscrambleState.answer = [];
            document.querySelectorAll('.letter-btn').forEach(btn => btn.classList.remove('used'));
            displayAnswerBlanks();
        }

        function submitAnswer() {
            const answer = unscrambleState.answer.map(item => item.letter).join('');

            if (answer === SECRET_MESSAGE) {
                createBigConfetti();
                showSection('victorySection');
            } else {
                const status = document.getElementById('status');
                status.textContent = '‚ùå Not quite right! Try again.';
                status.className = 'status error';
                setTimeout(() => {
                    clearAnswer();
                }, 1500);
            }
        }

        function answerYes() {
            createBigConfetti();
            alert('üéâ YESSSSS!!! I\'m so happy! You\'re the best! üíï');
        }

        function dodgeNo() {
            const noBtn = document.getElementById('noBtn');
            const yesBtn = document.getElementById('yesBtn');
            
            // Random position for no button
            const randomX = Math.random() * 200 - 100;
            const randomY = Math.random() * 200 - 100;
            
            noBtn.style.left = randomX + 'px';
            noBtn.style.top = randomY + 'px';
            
            // Make yes button bigger
            const currentSize = parseFloat(yesBtn.style.fontSize) || 1.2;
            yesBtn.style.fontSize = (currentSize + 0.2) + 'em';
            yesBtn.style.padding = (15 + currentSize * 5) + 'px ' + (40 + currentSize * 5) + 'px';
        }

        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            
            switch (e.key.toLowerCase()) {
                case 'arrowup':
                case 'w':
                    if (direction.y === 0) nextDirection = { x: 0, y: -1 };
                    e.preventDefault();
                    break;
                case 'arrowdown':
                case 's':
                    if (direction.y === 0) nextDirection = { x: 0, y: 1 };
                    e.preventDefault();
                    break;
                case 'arrowleft':
                case 'a':
                    if (direction.x === 0) nextDirection = { x: -1, y: 0 };
                    e.preventDefault();
                    break;
                case 'arrowright':
                case 'd':
                    if (direction.x === 0) nextDirection = { x: 1, y: 0 };
                    e.preventDefault();
                    break;
            }
        });

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = ['#667eea', '#764ba2', '#ff1493', '#ff69b4'][Math.floor(Math.random() * 4)];
                confetti.style.animation = `confettiFall ${2 + Math.random() * 1}s ease-out forwards`;
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        function createBigConfetti() {
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.width = (5 + Math.random() * 10) + 'px';
                confetti.style.height = confetti.style.width;
                confetti.innerHTML = ['üíï', 'üíñ', '‚ú®', 'üéâ', 'üíù'][Math.floor(Math.random() * 5)];
                confetti.style.backgroundColor = 'transparent';
                confetti.style.fontSize = '20px';
                confetti.style.animation = `confettiFall ${2 + Math.random() * 2}s ease-out forwards`;
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }
        }

        draw();
    </script>
</body>
</html>
